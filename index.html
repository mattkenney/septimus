<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<!-- @source:https://github.com/mattkenney/septimus -->
<title>Philly Train</title>
<meta content="width=device-width, initial-scale=1" name="viewport" />
<link href='//fonts.googleapis.com/css?family=Tauri' rel="stylesheet" type="text/css" />
<link href="/css/themes/septimus.min.css" rel="stylesheet" type="text/css" />
<link href="//cdnjs.cloudflare.com/ajax/libs/jquery-mobile/1.3.1/jquery.mobile.structure.css" rel="stylesheet" type="text/css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.0/jquery.min.js" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-mobile/1.3.1/jquery.mobile.min.js" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
(function(){var h=["30th Street Station","49th St","Airport Terminal A","Airport Terminal B","Airport Terminal C-D","Airport Terminal E-F","Allegheny","Allen Lane","Ambler","Angora","Ardmore","Ardsley","Bala","Berwyn","Bethayres","Bridesburg","Bristol","Bryn Mawr","Carpenter","Chalfont","Chelten Avenue","Cheltenham","Chester TC","Chestnut Hill East","Chestnut Hill West","Churchmans Crossing","Claymont","Clifton-Aldan","Colmar","Conshohocken","Cornwells Heights","Crestmont","Croydon","Crum Lynne","Curtis Park","Cynwyd","Darby","Daylesford","Delaware Valley College","Devon","Downingtown","Doylestown","East Falls","Eastwick Station","Eddington","Eddystone","Elkins Park","Elm St","Elwyn Station","Exton","Fern Rock TC","Fernwood","Folcroft","Forest Hills","Ft Washington","Fortuna","Fox Chase","Germantown","Gladstone","Glenolden","Glenside","Gravers","Gwynedd Valley","Hatboro","Haverford","Highland","Highland Ave","Holmesburg Jct","Ivy Ridge","Jenkintown-Wyncote","Langhorne","Lansdale","Lansdowne","Lawndale","Levittown","Link Belt","Main St","Malvern","Manayunk","Marcus Hook","Market East","Meadowbrook","Media","Melrose Park","Merion","Miquon","Morton","Mt Airy","Moylan-Rose Valley","Narberth","Neshaminy Falls","New Britain","Newark","Noble","Norristown TC","North Broad St","North Hills","North Philadelphia","North Wales","Norwood","Olney","Oreland","Overbrook","Paoli","Penllyn","Pennbrook","Philmont","Primos","Prospect Park","Queen Lane","Radnor","Ridley Park","Rosemont","Roslyn","Rydal","Ryers","Secane","Sedgwick","Sharon Hill","Somerton","Spring Mill","St. Davids","St. Martins","Stenton","Strafford","Suburban Station","Swarthmore","Tacony","Temple U","Thorndale","Torresdale","Trenton","Trevose","Tulpehocken","University City","Upsal","Villanova","Wallingford","Warminster","Washington Lane","Wayne Station","Wayne Jct","West Trenton","Whitford","Willow Grove","Wilmington","Wissahickon","Wister","Woodbourne","Wyndmoor","Wynnefield Avenue","Wynnewood","Yardley"],b={},m="",a="";
if(window.localStorage&&window.JSON){b=JSON.parse(localStorage.getItem("recent")||"[]");m=localStorage.getItem("from")||"";
a=localStorage.getItem("to")||"";}function f(){m=$("#stopfrom input").val();a=$("#stopto input").val();$.mobile.changePage("#routes");
}function k(r){if(r&&r.getHours){var o=r.getHours(),q=r.getMinutes(),p="AM",n;if(o>12){o-=12;p="PM";}n=o+":"+String(100+q).substring(1)+p;
}return n;}function l(n){return function(){b=_.filter(b,function(o){return(o.label!==n.label);});if(window.localStorage&&window.JSON){localStorage.setItem("recent",JSON.stringify(b));
}g();};}function e(n){return function(){$("#stopfrom input").val(n.from);$("#stopto input").val(n.to);f();};}function j(q,t,u,p,w){var v=$("<li></li>").appendTo(q).jqmData("theme","c"),x=p[w+"_line"]+" "+p[w+"_train"],n=p[w+"_departure_time"]||p[w+"_depart_time"],r=p[w+"_arrival_time"],o=p[w+"_delay"];
var s=v;$("<div></div>").appendTo(s).text(x).addClass("ui-li-desc");$("<div></div>").appendTo(s).text("Depart ").append(i(n,o));
$("<div></div>").appendTo(s).text("@ "+t);$("<div></div>").appendTo(s).text("Arrive ").append(i(r,o));$("<div></div>").appendTo(s).text("@ "+u);
}function d(p,n,o){return function(){p.val(o);n.empty();n.listview("refresh");n.trigger("updatelayout");};}function i(q,p){var n=$("<span></span>");
if((/^([0-9]+) mins$/).test(p)){var r=0|RegExp.$1,o=c(q);if(o){o.setTime(o.getTime()+r*60000);}o=k(o);$("<strike></strike>").appendTo(n).text(q);
n.append(" ");$("<i></i>").appendTo(n).text(o);}else{$("<span></span>").appendTo(n).text(q);$("<span></span>").appendTo(n).text(" ("+p+")");
}return n;}function c(r){if((/^\s*([0-9]+):([0-9]+)\s*(AM|PM)\s*$/i).test(r)){var n=0|RegExp.$1,q=0|RegExp.$2,p=RegExp.$3.toUpperCase(),o=new Date();
if(n===12){n=0;}if(p==="PM"){n+=12;}o.setHours(n);o.setMinutes(q);o.setSeconds(0);o.setMilliseconds(0);}return o;}function g(){var p=$("#recent ul"),r=_.sortBy(b,"label");
$("#stopfrom input").val("");$("#stopto input").val("");p.empty();for(var q=0;q<r.length;q++){var o=$("<li></li>").appendTo(p);
var n=$("<a></a>").attr("href","javascript:void(0)").text(r[q].label).appendTo(o).click(e(r[q]));n=$("<a></a>").attr("href","javascript:void(0)").jqmData("icon","delete").click(l(r[q])).appendTo(o);
}p.listview("refresh");p.trigger("updatelayout");$("#recent").toggle(!!r.length);}$(document).on("pageinit","#search",function(){$("#stopfrom ul,#stopto ul").on("listviewbeforefilter",function(r,q){var t=$(q.input),s=$(q.input).val().toLowerCase(),n=$(this);
n.empty();if(h&&s){var p=_.filter(h,function(u){return(s===u.substring(0,s.length).toLowerCase());});for(var o=0;o<p.length;
o++){$("<li></li>").text(p[o]).appendTo(n).click(d(t,n,p[o]));}}n.listview("refresh");n.trigger("updatelayout");});$("#search").on("pagebeforeshow",g);
$("#search form").on("submit",f);$("#find").click(f);});$(document).on("pageinit","#routes",function(){function n(s){var p=$("#routes-list");
p.empty();if(!s||!s.length){alert("No route found?!");return;}for(var q=0;q<s.length;q++){var o=$("<li></li>").jqmData("role","list-divider").jqmData("theme","c").text(s[q].orig_departure_time+" - "+(s[q].term_arrival_time||s[q].orig_arrival_time)).appendTo(p);
j(p,m,s[q].Connection||a,s[q],"orig");if(s[q].isdirect==="true"){continue;}$("<span></span>").text(" - 1 connection").appendTo(o);
j(p,s[q].Connection,a,s[q],"term");}p.listview("refresh");p.trigger("updatelayout");var r={from:m,to:a,label:m+" - "+a};b=_.filter(b,function(t){return(t.label!==r.label);
});b.push(r);while(b.length>10){b.shift();}if(window.localStorage&&window.JSON){localStorage.setItem("recent",JSON.stringify(b));
localStorage.setItem("from",m);localStorage.setItem("to",a);}}$("#routes").on("pagebeforeshow",function(){$("#routes-list").empty().listview("refresh").trigger("updatelayout");
});$("#routes").on("pageshow",function(){if(m&&a){$.mobile.loading("show");$.ajax("http://www3.septa.org/hackathon/NextToArrive/",{data:$.param({req1:m,req2:a}),dataType:"jsonp",complete:function(){$.mobile.loading("hide");
},success:n});}else{$.mobile.changePage("#search");}});});})();
/*]]>*/
</script>
</head>
<body>
<div data-role="page" id="search">
<div data-role="header"><h1>Philly Train</h1></div>
<div data-role="content">
<form action="javascript:void(0)">
<h2>Find Trip</h2>
<div id="stopfrom">
<ul data-filter="true" data-filter-placeholder="From station" data-inset="true" data-role="listview"></ul>
</div>
<div id="stopto">
<ul data-filter="true" data-filter-placeholder="To station" data-inset="true" data-role="listview"></ul>
</div>
<a href="javascript:void(0)" data-role="button" id="find">Find Trip</a>
<div id="recent">
<h2>Recent Trips</h2>
<ul data-inset="true" data-role="listview"></ul>
</div>
<div><a href="#about">About</a></div>
</form>
</div>
</div>
<div data-add-back-btn="true" data-role="page" id="routes">
<div data-role="header">
<a href="#search" data-icon="arrow-l">Back</a>
<h1>Philly Train</h1>
</div>
<div data-role="content">
<ul data-inset="true" data-role="listview" data-theme="c" id="routes-list"></ul>
</div>
</div>
<div data-add-back-btn="true" data-role="page" id="detail">
<div data-role="header">
<a href="#routes" data-icon="arrow-l">Back</a>
<h1>Philly Train</h1>
</div>
<div data-role="content">
<ul data-inset="true" data-role="listview" id="detail-list"></ul>
</div>
</div>
<div data-role="page" id="about">
<div data-role="header">
<a href="#search" data-icon="arrow-l">Back</a>
<h1>Philly Train</h1>
</div>
<div data-role="content">
<div>
Powered by <a href="http://www3.septa.org/hackathon/">SEPTA</a>.
</div>
<div>
Inspired by <a href="http://baldwin.ph">Baldwin</a>.
</div>
<div>
Developed by matt<img alt="@" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAANBJREFUKFO10LErxXEUBfDPk5IysCqljAblbcrKxiTym92/gEGGt7BJJsP9DywWBullovcnGN5o8LKQyWjw9fpSJjnTPbdzuuce/hutmkTEGHbRYA6v6OIwMx9gpBKP4xaLxTCBBdyjGxHLMFod2MdjZm5VuwHOIqKPU7RrQ4M1iIhzTGIlM1u4wzxVJMygX+Z1HBTzNE5w/dMwwGyZL3GEd9zgGdt8/+ECe9jJzA2/YFhrREyh57PGYzxhFZuZ2XzphpEy8wVLhfbwhg6u/AUfN6o0SCbgjeIAAAAASUVORK5CYII=" />phillytrain.com.
</div>
</div>
</div>
</body>
</html>

